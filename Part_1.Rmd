---
title: 'Part 1: Simulation Exercise'
author: "Andrew Perelson"
date: "March 15, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview

This project investigates the exponential distribution in R and compares it with the Central Limit Theorem. Lambda will be set to 0.2 for all of the simulations and the report investigates the distribution of averages of 40 exponentials for a thousand simulations.

## Simulations

## Comparing The Sample and Theoretical Means

Set the seed (for repeatability), lambda and exponentials and load required 
library:

```{r}
library(ggplot2)
set.seed(2000)
lambda <- 0.2
exp <- 40
sim <- NULL
```

Run the required simulations with the above set variables

```{r}
for (i in 1 : 1000) sim <- c(sim, mean(rexp(exp, lambda)))
```

#### Determine the sample mean:

```{r}
sampleMean <- mean(sim)
print(sprintf("The sample mean converged to: %f", sampleMean))
```

#### Determine the theoretical mean:
The theoretical mean of an exponential distribution is lambda^-1.

```{r}
theoreticalMean <- lambda^-1
print(sprintf("The theoretical mean converged to: %f", theoreticalMean))
```

#### Comparison of the sample vs theoretical means:
There is only a slight difference between the sample mean and the theoretical mean.

```{r}
abs(sampleMean-theoreticalMean)
```

## Comparing The Sample and Theoretical Variance
#### Determine the sample variance:

```{r}
sampleVariance <- var(sim)
print(sprintf("The sample variance: %f", sampleVariance))
```

#### Determine the theoretical variance:
The theoretical variance of an exponential distribution is (lambda * sqrt(n))^-2.

```{r}
theoreticalVariance <- (lambda * sqrt(exp))^-2
print(sprintf("The theoretical variance: %f", theoreticalVariance))
```

#### Comparison of the sample vs theoretical variance:

There is a slight difference between the simulation sample variance and the 
exponential distribution theoretical variance:

```{r}
abs(sampleVariance-theoreticalVariance)
```

#### Showing that the distribution is approximately normal:
This is a density histogram of the 1000 simulations. There is an overlay with a 
normal distribution that has a mean of lambda^-1 and standard deviation of 
(lambda*sqrt(n))^-1, the theoretical normal distribution for the simulations.

```{r}
ggplot(data.frame(y=sim), aes(x=y)) + 
  geom_histogram(aes(y=..density..), binwidth=0.2, fill="wheat", color="black") +
  stat_function(fun=dnorm, args=list(mean=lambda^-1, sd=(lambda*sqrt(exp))^-1)) +
  labs(title="Distribution compared to normal", x="Mean", y="Density")
```



